
const PAI_o={status_o:null,SCALE_H_n:1,SCALE_V_n:2,hue_o:{grade_n:0,gap_n:0},sat_o:{grade_n:0,gap_n:0},lum_o:{grade_n:0,gap_n:0},layer_o:{perspective_n:0,distance_n:0,rotation_n:0},message__v:e=>{switch(e.task_s){case"PUT_status":PAI_o.status_o=e.status_o;break;case"PUT_error":console.log(`ERROR: ${e.error_s}`)}},range__v:(e,_)=>{const t=e.value;e.dataset.tip=t;const[,,a,n]=e.id.split("_");_&&_(a,n,t)},canvas__v:(e,_,t)=>{PAI_o.SCALE_H_n,PAI_o.SCALE_V_n},canvas__e:(e,_)=>{const t=document.createElement("canvas");return _&&_(t),t},layer__n:()=>Array.from(document.getElementById("DI_paint_layer_items").querySelectorAll("li")).length,addLayer__v:e=>{const _=PAI_o.layer__n();if(_>=4)return void alert("Le nombre de plans maximum est atteint ");let t="",a="",n="";_&&(a=`input_${e}_${_}`,t=`<input id="${a}" data-layer_n=${_} type="checkbox">`,n=`for="${a}"`),DOM_o.appendNode__v(DOM_o.fragment__e(`<li data-layer_n=${_}>`+t+`<label ${n}>plan ${_+1}</label></li>`),"DI_paint_layer_items"),DOM_o.beforeNode__v(PAI_o.canvas__e(e,(e=>{e.dataset.layer_n=_,e.dataset.size_n=1,document.documentElement.style.setProperty(`--paint_canvas_ratio_${_}`,1)})),"DI_paint_layer_position")},selected__a:()=>Array.from(document.querySelectorAll("#DI_paint_layer_items > li[data-layer_n] > input:checked")),hideLayer__v:()=>{const e=PAI_o.selected__a();if(e.length)for(selected_e of e){const e=selected_e.dataset.layer_n;for(node_e of Array.from(document.querySelectorAll(`[data-layer_n="${e}"]`)))node_e.dataset.layer_b=0,node_e.checked&&(node_e.checked=!1)}else alert("Aucun plan n'est sélectionné")},imgResize__v:e=>{for(selected_e of PAI_o.selected__a()){const _=selected_e.dataset.layer_n;for(canvas_e of Array.from(document.querySelectorAll(`canvas[data-layer_n="${_}"]`))){let t=e+ +canvas_e.dataset.size_n;canvas_e.dataset.size_n=t,document.documentElement.style.setProperty(`--paint_canvas_ratio_${_}`,t)}}},increase__v:e=>{PAI_o.imgResize__v(.025)},decrease__v:e=>{PAI_o.imgResize__v(-.025)},listener__v(){for(let e of["hue","sat","lum"]){for(let _ of["grade","gap"]){const t=document.getElementById(`IN_paint_${e}_${_}`);for(let e of["click","keydown"])t&&t.addEventListener(e,(e=>{PAI_o.range__v(e.target,((e,_,t)=>PAI_o[`${e}_o`][`${_}_n`]=+t))}))}const _=document.getElementById(`canvas_paint_${e}`);_&&_.addEventListener("click",(e=>{const{offsetX:_,offsetY:t}=e;PAI_o.canvas__v(e.target.id,_,t)}))}for(let e of["perspective","distance","rotate","scale"]){const _=document.getElementById(`IN_paint_layer_${e}`);for(let e of["click","keydown"])_&&_.addEventListener(e,(e=>{PAI_o.range__v(e.target,((e,_,t)=>{PAI_o[`${e}_o`][`${_}_n`]=+t,DOM_o.rootVar__v(`--paint_${_}`,+t)}))}))}const e=document.getElementById("LA_paint_layer_add");e&&e.addEventListener("click",(e=>{PAI_o.addLayer__v(document.querySelector("body").dataset.work_s)}));const _=document.getElementById("LA_paint_layer_hide");_&&_.addEventListener("click",(e=>{PAI_o.hideLayer__v()}))},init__v(){PAI_o.worker_o=STAT_o.worker__o("paint","LogScale Painter",PAI_o.message__v),PAI_o.addLayer__v(document.querySelector("body").dataset.work_s),PAI_o.listener__v()}};PAI_o.init__v();