
class ColorBurst{constructor(t){Object.assign(this,t),this.context_o=t.canvas_o.getContext("2d"),this.unit_n=t.capacity_n*(2*Math.PI)/t.capacity_n,this.paint_c=new Painter(this.context_o),this.plots_a=[],this.clearWidth_n=this.canvas_o.width,this.clearHeight_n=this.canvas_o.height,this.draw__v()}coord__a(t,e){const s=t*this.unit_n-.5*Math.PI;return[~~(e*Math.cos(s)+this.center_n),~~(e*Math.sin(s)+this.center_n)]}draw__v(t=1){
//!!!!!!!!!!!!!!!!!!!!!!!!!!
//!!!!!!!!!!!!!!!!!!!!!!!!!!
this.filter__n();const e=new LogScale({minpos_n:0,maxpos_n:1e3,minval_n:0,maxval_n:this.maxfreqFilterd_n}),s=t/this.frequency_a.length;let _=0;this.clear__v();for(let t of this.filtered_a){if(t){const n=e.position__n(t.frequency_n),[i,h]=this.coord__a(_,n);_+=s;const[r,a]=this.coord__a(_,n);this.plots_a.push({startX_n:i,startY_n:h,endX_n:r,endY_n:a}),this.paint_c.fill__c(t.hsl_a).path__c(`M ${i} ${h}\n               A 0 0 0 0 0 ${r} ${a}\n               L ${this.center_n} ${this.center_n}`)}else this.plots_a.push(null),_+=s;0}
//!!!!!!!!!!!!!!!!!!!!!!!!!!
//!!!!!!!!!!!!!!!!!!!!!!!!!!
}filter__n(){this.filtered_a=[],this.maxfreqFilterd_n=this.maxfreq_n;for(let t of this.frequency_a)if(t){const e=t.frequency_n;e>this.maxfreq_n&&(this.maxfreqFilterd_n=e)}let t,e;100===this.thresh_o.hi_n&&0===this.thresh_o.lo_n?(t=this.maxfreqFilterd_n,e=0):(t=this.maxfreqFilterd_n-this.maxfreqFilterd_n*(.01*(100-this.thresh_o.hi_n)),e=this.maxfreqFilterd_n*this.thresh_o.lo_n*.01);for(let s of this.frequency_a){const _=s?.frequency_n;_>0?this.filtered_a.push(_<=t&&_>=e?s:null):this.filtered_a.push(null)}}plots__a(t){return null!=t?this.plots_a[t]:this.plots_a}clear__v(){this.context_o.save(),this.context_o.clearRect(0,0,this.clearWidth_n,this.clearHeight_n),this.context_o.restore()}reset__v(){this.context_o.resetTransform()}}