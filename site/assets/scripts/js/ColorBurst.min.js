
class ColorBurst{constructor(t){Object.assign(this,t),this.context_o=t.canvas_o.getContext("2d"),this.unit_n=t.capacity_n*(2*Math.PI)/t.capacity_n,this.paint_c=new Painter(this.context_o),this.level_a=[],this.clearWidth_n=this.canvas_o.width,this.clearHeight_n=this.canvas_o.height,this.draw__v()}locate__a(t,e){const _=t*this.unit_n-.5*Math.PI;return[~~(e*Math.cos(_)+this.center_n),~~(e*Math.sin(_)+this.center_n)]}draw__v(t=1){
//!!!!!!!!!!!!!!!!!!!!!!!!!!
//!!!!!!!!!!!!!!!!!!!!!!!!!!
this.filter__v();const e=new LogScale({minpos_n:0,maxpos_n:1e3,minval_n:0,maxval_n:this.maxRateFiltered_n}),_=t/this.rate_a.length;let s=0;this.clear__v();for(let t of this.filtered_a){if(t){const i=e.locate__n(t.rate_n),[a,n]=this.locate__a(s,i);s+=_;const[h,l]=this.locate__a(s,i);this.level_a.push({startX_n:a,startY_n:n,endX_n:h,endY_n:l}),this.paint_c.fill__c(t.hsl_a).path__c(`M ${a} ${n}\n               A 0 0 0 0 0 ${h} ${l}\n               L ${this.center_n} ${this.center_n}`)}else this.level_a.push(null),s+=_;0}
//!!!!!!!!!!!!!!!!!!!!!!!!!!
//!!!!!!!!!!!!!!!!!!!!!!!!!!
}filter__v(){this.filtered_a=[],this.maxRateFiltered_n=this.maxRate_n;for(let t of this.rate_a)if(t){const e=t.rate_n;e>this.maxRate_n&&(this.maxRateFiltered_n=e)}let t,e;100===this.thresh_o.hi_n&&0===this.thresh_o.lo_n?(t=this.maxRateFiltered_n,e=0):(t=this.maxRateFiltered_n-this.maxRateFiltered_n*(.01*(100-this.thresh_o.hi_n)),e=this.maxRateFiltered_n*this.thresh_o.lo_n*.01);for(let _ of this.rate_a){const s=_?.rate_n;s>0?this.filtered_a.push(s<=t&&s>=e?_:null):this.filtered_a.push(null)}}level__a(t){return null!=t?this.level_a[t]:this.level_a}clear__v(){this.context_o.save(),this.context_o.clearRect(0,0,this.clearWidth_n,this.clearHeight_n),this.context_o.restore()}reset__v(){this.context_o.resetTransform()}}