
const PAN_o={index__n:()=>{let e=0;for(let t=0;t<localStorage.length;++t){const o=localStorage.key(t),r=JSON.parse(localStorage.getItem(o)).created_n;r>e&&(e=r)}return e},nextIndex__n:()=>{const e=+DOM_o.rootVar__s("--panorama_n")+1;return DOM_o.rootVar__v("--panorama_n",e),e},img__e:e=>e.target.parentNode.querySelector("img"),img__s:e=>e.substring("https://chercheurdart-2.netlify.app/assets/media/img/".length,e.lastIndexOf(".")),add__v:e=>{const t=PAN_o.img__e(e),o=PAN_o.img__s(t.src);if(!localStorage.getItem(o)){let r=e.target.parentNode.id.substring(2);const _=document.querySelector(`#G${r} figcaption`);r+="_"+o.substring(o.lastIndexOf("/")+1),localStorage.setItem(o,JSON.stringify({id_s:r,created_n:PAN_o.nextIndex__n(),width_s:t.width,height_s:t.height,caption_s:_.innerHTML,display_b:!0})),PAN_o.show__v()}},show__v:()=>{let e="",t=[];for(let e=0;e<localStorage.length;++e){const o=localStorage.key(e);t.push({key_s:o,value_o:JSON.parse(localStorage.getItem(o))})}for(at_o of(t.sort(((e,t)=>e.value_o.created_n-t.value_o.created_n)),t)){const t=at_o.value_o;e+=`<figure data-id="P${t.id_s}" data-display_b="${t.display_b}"><img src="https://chercheurdart-2.netlify.app/assets/media/img/${at_o.key_s}.avif" width="${t.width_s}" height="${t.height_s}" loading="lazy"><a href="#AC${t.id_s}"><figcaption>`+t.caption_s+"</figcaption></a></figure>\n"}for(figure_e of(document.getElementById("DI_panorama_masonry").innerHTML=e,Array.from(document.querySelectorAll("#DI_panorama_masonry > figure"))))figure_e.addEventListener("click",PAN_o.select__v)},select__v:e=>{const t=e.target.closest("figure");t&&t.classList.toggle("selected")},hide__v:()=>{for(figure_e of Array.from(document.querySelectorAll("figure.selected"))){figure_e.dataset.display_b=!1;const e=PAN_o.img__s(figure_e.querySelector("img").src);let t=localStorage.getItem(e);if(t){const o=t.match(/"display_b":(?<display_b>true|false)/i).groups.display_b,r="false"===o?"true":"false";localStorage.setItem(e,t.replace(`"display_b":${o}`,`"display_b":${r}`)),PAN_o.show__v()}}},remove__v:()=>{for(figure_e of Array.from(document.querySelectorAll("figure.selected")))localStorage.removeItem(PAN_o.img__s(figure_e.querySelector("img").src)),figure_e.parentNode.removeChild(figure_e)},group__v:()=>{let e,t;for(figure_e of Array.from(document.querySelectorAll("figure.selected"))){if(!e){e=figure_e.parentNode,t=figure_e;continue}const o=e.removeChild(figure_e);e.insertBefore(o,t.nextSibling),t=o}let o=[];for(figure_e of Array.from(document.querySelectorAll("#DI_panorama_masonry > figure"))){const e=PAN_o.img__s(figure_e.querySelector("img").src),t=JSON.parse(localStorage.getItem(e)),r=PAN_o.nextIndex__n();t.created_n=r,o.push({key_s:e,value_s:JSON.stringify(t)}),localStorage.removeItem(e)}for(at_a of o)localStorage.setItem(at_a.key_s,at_a.value_s)},rangeEvent__v:e=>{const t=e.target,o=t.value;t.dataset.tip=o,DOM_o.rootVar__v("--panorama_col_n",o)},listen__v:()=>{for(let e of["hide","remove","group"]){const t=document.getElementById(`LA_panorama_${e}`);t&&t.addEventListener("click",PAN_o[`${e}__v`])}for(label_e of Array.from(document.querySelectorAll('figure > label[data-legend="panorama"]')))label_e.addEventListener("click",PAN_o.add__v);DOM_o.rootVar__v("--panorama_n",PAN_o.index__n());for(let e of["col_n"])for(let t of["click","keydown"])DOM_o.listener__v(`IN_panorama_${e}`,PAN_o.rangeEvent__v,t);DOM_o.rootVar__v("--panorama_col_n","2")}};PAN_o.listen__v(),PAN_o.show__v();