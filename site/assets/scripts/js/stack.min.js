
const STACK_o={status_o:null,message__v:e=>{switch(e.task_s){case"PUT_status":STACK_o.status_o=e.status_o;break;case"PUT_error":console.log(`ERROR: ${e.error_s}`)}},appendNode__v:(e,t)=>{document.getElementById(t)?.appendChild(e)},beforeNode__v:(e,t)=>{const _=document.getElementById(t);_&&_.parentNode.insertBefore(e,_)},fragment__e:(e,t)=>{const _=document.createRange().createContextualFragment(e);return t?STACK_o.beforeNode__v(_,t):_},img__e:(e,t)=>{const _=document.createElement("img");return _.addEventListener("load",(e=>t&&t(_))),_.src=`assets/media/img/${e}/full/max/0/color.avif`,_},addWork__v:e=>{const t=document.getElementById("DI_stack_layers_items").children.length;let _="",a="",n="";t&&(a=`input_${e}_${t}`,_=`<input id="${a}" data-layer_n=${t} type="checkbox">`,n=`for="${a}"`),STACK_o.appendNode__v(STACK_o.fragment__e(`<li data-layer_n=${t}>`+_+`<label ${n}>${e}</label></li>`),"DI_stack_layers_items"),STACK_o.beforeNode__v(STACK_o.img__e(e,(_=>{_.id=`img_${e}_${t}`,_.dataset.layer_n=t,_.dataset.size_n=1,document.documentElement.style.setProperty(`--stack_img_ratio_${t}`,1)})),"stack_scale"),STACK_o.fragment__e(`<li data-layer_n=${t}>\n          <input  id="IN_stack_layer_animation_play_${t}" data-layer_n=${t} name=stack_animation type="radio">\n          <label for="IN_stack_layer_animation_play_${t}">\n            <svg class="svg_icon">\n              <use href="#stack_circle"></use>\n              <title>${t} &#8942; ${e}</title>\n            </svg>\n          </label>\n        </li>`,"LI_stack_layer_animation_play")},add_remote__v:e=>{document.getElementById(`IF_stack_${e}`)&&IND_o.adopt__v("DI_stack_settings",`IF_stack_${e}`,((e,t)=>{const _=t.querySelector("#script_stack_imgs");_&&(_.src=_.dataset.src)}))},selected__a:()=>Array.from(document.querySelectorAll("#DI_stack_layers_items > li[data-layer_n] > input:checked")),add_local:e=>{console.log("add_local")},hide__v:e=>{for(selected_e of STACK_o.selected__a()){const e=selected_e.dataset.layer_n;for(node_e of Array.from(document.querySelectorAll(`[data-layer_n="${e}"]`)))node_e.setAttribute("data-layer_b","0")}},moveNode__v:e=>{const t=STACK_o.selected__a()?.[0]?.parentNode;if(!t)return void alert("Aucune image n'est sélectionnée");const _=t=>{const _=document.querySelector(t);let a=_[`${e}Sibling`];a&&"next"===e&&(a=a.nextSibling),"0"!==a?.dataset?.layer_n&&_.parentNode.insertBefore(_,a)},a=t.dataset.layer_n;_(`#DI_stack_layers_items > li[data-layer_n="${a}"]`),_(`#DI_stack_layer_animation > li[data-layer_n="${a}"]`),_(`img[data-layer_n="${a}"]`)},up__v:e=>{STACK_o.moveNode__v("previous")},down__v:e=>{STACK_o.moveNode__v("next")},imgResize__v:e=>{for(selected_e of STACK_o.selected__a()){const t=selected_e.dataset.layer_n;for(img_e of Array.from(document.querySelectorAll(`img[data-layer_n="${t}"]`))){let _=e+ +img_e.dataset.size_n;img_e.dataset.size_n=_,document.documentElement.style.setProperty(`--stack_img_ratio_${t}`,_)}}},increase__v:e=>{STACK_o.imgResize__v(.025)},decrease__v:e=>{STACK_o.imgResize__v(-.025)},align__v:e=>{const t=STACK_o.selected__a()?.[0];if(!t)return void alert("Aucune image n'est sélectionnée");const _=t?.dataset?.layer_n,a=document.querySelector(`img[data-layer_n="${_}"]`),n=document.querySelector("#IN_stack_align:checked")?"remove":"add";a.classList[`${n}`]("layer_align");const o="add"===n?"set":"remove";a[`${o}Attribute`]("draggable","set"===o);for(let e of["offx","offy"])a.dataset[e]||(a.dataset[e]=0);document.getElementById("IN_stack_settings").checked=!1,document.getElementById("IN_stack_img").checked=!0,STACK_o.dragImg__v(a,"remove"===n)},dragImg__v:(img_e,remove_b=!1)=>{const down__v=e=>(gapX_n=e.clientX-offsetX_n,gapY_n=e.clientY-offsetY_n,listen__v(["move","up"],"add"),!1),move__v=e=>(e.preventDefault(),atX_n=e.clientX-gapX_n,atY_n=e.clientY-gapY_n,offsetX_n=atX_n,offsetY_n=atY_n,img_e.style.transform=`translate3d(${atX_n}px, ${atY_n}px, 0)`,!1),up__v=e=>(listen__v(["move","up"]),img_e.dataset.offx=~~(atX_n+ +img_e.dataset.offx),img_e.dataset.offy=~~(atY_n+ +img_e.dataset.offy),!1),listen__v=(event_a,method_s="remove")=>{for(let event_s of event_a)img_e[`${method_s}EventListener`](`pointer${event_s}`,eval(`${event_s}__v`))};if(remove_b)return void img_e.removeEventListener("pointerdown",down__v);let gapX_n=0,gapY_n=0,offsetX_n=0,offsetY_n=0,atX_n=0,atY_n=0;img_e.addEventListener("pointerdown",down__v)},listener__v(){for(op_e of Array.from(document.querySelectorAll('[id^="stack_scale_"]')))op_e.addEventListener("click",(e=>{const t=e.target.id.slice(-3),_=window.getComputedStyle(document.documentElement).getPropertyValue("--stack_img_width"),a="inc"===t?5:-5;document.documentElement.style.setProperty("--stack_img_width",+_+a)}));for(let e of["add_remote","add_local","hide","up","down","increase","decrease","align"]){const t=document.getElementById(`LA_stack_${e}`);t&&t.addEventListener("click",(t=>STACK_o[`${e}__v`](e)))}},init__v(){for(work_s of(STACK_o.addWork__v(document.querySelector("body").dataset.work_s),Array.from(document.querySelector("body").dataset.layer_s.split(" "))))STACK_o.addWork__v(work_s);STACK_o.listener__v()}};STACK_o.init__v();